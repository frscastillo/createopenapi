# Documentacion de modulos JavaScript

El siguiente listado resume quien consume cada archivo JavaScript del proyecto (`createopenapi/js`) y para que se utiliza. Se ignoran dependencias de terceros ubicadas en `lib/`.

| Archivo | Quien lo utiliza | Para que se utiliza | Detalles relevantes |
| --- | --- | --- | --- |
| `js/main.js` | `index.html` (script principal en navegador); depende de `curlConverter`, `openAPIViewer`, `metadataEditor`, `AppState`, `ErrorHandler`, utilidades | Orquesta el flujo de la aplicacion: inicializa Swagger UI, carga ejemplos iniciales, maneja eventos de UI (convertir CURL, descargar YAML, agregar respuestas) y actualiza el estado compartido | Punto de entrada del frontend. Coordina notificaciones, atajos de teclado y exportacion YAML usando `SchemaUtils` y `ValidationUtils` |
| `js/curlConverter.js` | `js/main.js`, `js/transform.js`, pruebas `tests/curlConverter.test.js` | Convierte un comando CURL en una especificacion OpenAPI: parsea URL, parametros, headers y cuerpos; detecta esquemas de seguridad y genera respuestas | Expone `curlToOpenAPI` y utilidades de parsing. Usa `ValidationUtils`, `SchemaUtils` y constantes centralizadas |
| `js/jsonConverter.js` | Actualmente no se importa en los flujos principales; disponible para uso manual o integracion futura | Ofrece utilidades basicas para validar cadenas JSON y generar una especificacion OpenAPI de ejemplo a partir de un JSON plano | Exporta `validateJSON` y `jsonToOpenAPI`. No esta integrado con el UI actual |
| `js/metadataEditor.js` | Invocado por `js/main.js` cuando el usuario abre el modal de metadatos | Gestiona el modal de edicion de metadatos: carga valores del spec actual, permite modificar info general, parametros, request body y respuestas, y aplica cambios mediante `updateOpenAPISpec` | Mantiene copia local de la especificacion en edicion y sincroniza con `openAPIViewer` |
| `js/openAPIViewer.js` | Inicializado desde `js/main.js`; consultado por `js/metadataEditor.js` para leer/actualizar el spec | Encapsula la integracion con Swagger UI (`SwaggerUIBundle`), carga una especificacion por defecto y expone funciones para actualizar la vista y compartir la version actual de la especificacion | Mantiene estado interno (`ui`, `currentSpec`) y sincroniza la version con `window.__CURRENT_OPENAPI_SPEC` |
| `js/security.js` | Importado por `js/main.js` (para validaciones de entrada futuras) y cubierto en `tests/security.test.js` | Provee la clase `SecurityValidator` para sanitizar input de CURL, validar comandos, revisar JSON de respuesta y aplicar un rate limit basico en cliente | Utiliza `localStorage` para limitar llamadas y expone helpers publicos estaticos |
| `js/transform.js` | Utilizado por `tests/unit/transform.test.js` y scripts que necesiten un YAML directo | Encapsula la transformacion de un CURL y respuestas adicionales directamente a YAML OpenAPI, usando `curlToOpenAPI` y `SchemaUtils` | Exporta `transform` y su default; pensado para pipelines o generacion sin UI |
| `js/services/AppState.js` | Consumido por `js/main.js`, `js/services/ErrorHandler.js`, `js/services/NotificationManager.js`, pruebas de servicios | Implementa un estado centralizado con patron Observer: gestiona spec actual, historial, notificaciones, configuracion y helpers para mutar estado | Exporta instancia singleton `appState` y clase `AppState`; persiste configuracion en `localStorage` |
| `js/services/ErrorHandler.js` | Llamado en `js/main.js`, `js/services/NotificationManager.js` indirectamente via `appState`, pruebas `tests/services.errorHandler.test.js` | Centraliza manejo de errores: parsea excepciones, registra logs estructurados, muestra notificaciones de usuario y permite reportes externos | Registra listeners globales `window.onerror` y `unhandledrejection`; usa `appState` para notificar |
| `js/services/NotificationManager.js` | Se auto-inicializa al `DOMContentLoaded`; observa `appState` | Renderiza notificaciones en la UI, crea/retira elementos DOM y sincroniza con la cola en `appState` | Genera contenedor y estilos dinamicamente cuando no existen |
| `js/utils/constants.js` | Importado en `AppState`, `ErrorHandler`, `curlConverter`, `SchemaUtils`, `ValidationUtils`, `main` | Define constantes compartidas: timeouts, limites de validacion, listas de campos y headers, metadatos OpenAPI y tipos de contenido | Sirve como unica fuente de configuracion estatica |
| `js/utils/schema.js` | Utilizado por `curlConverter`, `main` (via utilidades), `transform`, `SchemaUtils` se usa en `metadataEditor` indirectamente, pruebas unitarias | Ofrece helpers para generar/normalizar schemas JSON y extraer esquemas de seguridad desde headers; procesa especificaciones para cumplir convenciones OpenAPI | Complementa `ValidationUtils` para determinar campos requeridos y ordenar propiedades |
| `js/utils/validation.js` | Base para `curlConverter`, `SchemaUtils`, `main`, pruebas `tests/utils.validation.test.js` | Contiene logica de validacion reutilizable: comandos CURL, JSON de respuesta, parametros, headers y codigos HTTP | Centraliza heuristicas de requeridos/opcionales y limites de tamano/profundidad |

> Nota: Los modulos de prueba ubicados en `tests/` ejercitan estas piezas pero no se incluyen en la tabla anterior, ya que la solicitud se enfoco en el codigo JavaScript de la aplicacion.
